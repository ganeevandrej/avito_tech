import{L as p,r as u,j as r,S as i,T as c,n as l}from"./index-DsGleIZ-.js";import{u as g,i as h,S as j,a as w}from"./client-I7yiFdsh.js";import{N as f,j as k,a as m,k as A,H as E,n as I,o as N,p as T}from"./ModerationActions-CJG_vZB7.js";const L=()=>{const{id:x}=p(),t=u.useRef(null),o=Number(x),a=g({queryKey:["ad",o],queryFn:({signal:n})=>T(o,n),enabled:Number.isInteger(o)});if(u.useEffect(()=>{const n=e=>{const d=e.target;if(!((d.tagName==="INPUT"||d.tagName==="TEXTAREA")&&e.key!=="/")){if(e.key==="a"||e.key==="A"){e.preventDefault(),t.current?.handleApprove?.();return}if(e.key==="d"||e.key==="D"){e.preventDefault(),t.current?.handleReject?.();return}if(e.key==="s"||e.key==="S"){e.preventDefault(),t.current?.handleRequestChanges?.();return}if(e.key==="ArrowLeft"){e.preventDefault(),t.current?.goToPrev?.();return}e.key==="ArrowRight"&&(e.preventDefault(),t.current?.goToNext?.())}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),!Number.isInteger(o))return r.jsx(f,{});if(a.isLoading)return r.jsx(k,{});if(a.isError){if(h.isAxiosError(a.error)&&a.error.response?.status===404)return r.jsx(f,{});throw new Error("Непредвиденная ошибка при загрузке объявления")}if(!a.data)throw new Error("Данные объявления не найдены");const s=a.data,y=s.priority==="urgent";return r.jsxs(i,{spacing:4,children:[r.jsxs(i,{spacing:1,children:[r.jsxs(i,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",children:[r.jsx(c,{variant:"h4",fontWeight:700,children:s.title}),y&&r.jsx(m,{label:"Срочно",color:"error",size:"small"}),r.jsx(m,{label:j[s.status],color:"primary",size:"small",variant:"outlined"})]}),r.jsxs(c,{variant:"body2",color:"text.secondary",children:["Объявление #",s.id," · обновлено ",w(s.updatedAt)]})]}),r.jsxs(i,{direction:{xs:"column",md:"row"},spacing:3,children:[r.jsx(l,{flex:1,children:r.jsx(A,{images:s.images})}),r.jsx(l,{flex:1,children:r.jsx(E,{history:s.moderationHistory})})]}),r.jsx(I,{ad:s}),r.jsx(N,{adId:o,actionsRef:t})]})};export{L as default};
